---
layout: single
title: "[디지털영상처리] -2장"
categories: imageProcessing
tags: [디지털영상처리]
sidebar:
    nav: "counts"

---

# 1 에지(Edge)

## 01. 에지 검출

에지는 경계선을 뜻한다. 

사람은 이미지를 볼 때, 사람과 파라솔을 잘 구분해 낼 수 있다.

하지만, 컴퓨터는 구분을 잘 할 수 없어서 `에지 검출`을 사용해야 한다. 

![image-20230918114758836]({{site.url}}/images/2023-09-18-2day/image-20230918114758836.png)



### 에지 검출 알고리즘

물체 내부는 명암이 서서히 변하고 경계는 급격히 변하는 특성을 활용한다. 

에지 검출을 하기 위해선 `미분`을 사용해야 한다.

미분은 특정한 것을 나누는 것으로 영상에 적용하면 경계선이 잘 나타나는 것을 알 수 있다. 



### 실제 구현

실제로 구현하려면 필터 즉, 에지 연산자(u)가 필요하다.

1차 미분일 땐, 에지 연산자가 `-1 1 `이다.

##### 😮 1차 미분

컨볼루션의 커널(에지 연산자)를 원래 영상과 곱해서 더하면 에지가 검출된다. 

![image-20230918120556768]({{site.url}}/images/2023-09-18-2day/image-20230918120556768.png)

즉, 1차 미분에서는 0000003000 이렇게 3이 나오면서 에지가 검출된 것을 확인한다.



2차 미분일 때, 에지 연산자는` 1 -2 1 `이다.

`1차 미분 에지 검출 구현`

`2차 미분 에지 검출 구현`

- 램프 : 픽셀이 서서히 증가하거나 감소하는 부분 -> 2차 미분에서는 봉우리 찾기
- 계단 : 값이 갑자기 뚝하고 떨어지는 부분 -> 2차 미분에서는 영교차 찾기

![image-20230918120833090]({{site.url}}/images/2023-09-18-2day/image-20230918120833090.png)

1차 미분에 기반한 에지 연산자는 실제 영상에 있는 잡음을 흡수하기 위해 크기가 2인 필터를 `크기가 3인 필터`로 확장한다

또한 1차원을 2차원으로 확장한다 

아래 그림이 `2`차원으로 확장한 예시이다. 

![image-20230918120933262]({{site.url}}/images/2023-09-18-2day/image-20230918120933262.png)



### ⭐에지 강도와 방향

에지 강도와 방향을 알 수 있다. 

에지 강도의 값이 크면 `에지 가능성이 높다`는 것을 알 수 있다. 

![image-20230918121100767]({{site.url}}/images/2023-09-18-2day/image-20230918121100767.png)

#### ⭐ 소벨 연산자 적용 과정

![image-20230918121229047]({{site.url}}/images/2023-09-18-2day/image-20230918121229047.png)

![image-20230918123532020]({{site.url}}/images/2023-09-18-2day/image-20230918123532020.png)

tan의 역 arctan 계산 법도 알아야겠다...



## 2. 캐니 에지

앞에서 에지 연산자를 이용한 방식 보다 `캐니 에지`를 사용하면 경계선들을 잘 나타낼 수 있다. 

에지 검출을 최적화 문제로 풀어 `최소 오류율, 위치 정확도, 한 두께` 라는 세가지 기준으로 목적 함수를 정의한다.

한 두께를 위해 `비최대 억제`를 적용한다.

거짓 긍정을 줄이기 위해 두 개의 이력 임계값을 사용한다.



### 🖥️코드

![image-20230918121333994]({{site.url}}/images/2023-09-18-2day/image-20230918121333994.png)

![image-20230918121424901]({{site.url}}/images/2023-09-18-2day/image-20230918121424901.png)

캐니 에지는 주관적인 값으로 나타내어 실제로 `번호판 인식 시스템` 등을 구축할 땐, 에지 연산자로 검출을 먼저 한 뒤 캐니 에지를 사용하는 방법으로 진행한다.

즉, 캐니 에지는 최적의 범주가 아니다.



## 3. 직선 검출

에지를 명시적으로 연결해 경계선을 찾고 `직선`으로 변환하는 것이다.

이후 처리 단계인 `물체 표현, 인식`에 유리하다.



직선 검출을 하려면 제일 먼저 경계선을 찾아야 한다.

### 경계선 찾기

8- 연결된 에지 화소를 연결해 `경계선Contour` 구성

![image-20230918121501945]({{site.url}}/images/2023-09-18-2day/image-20230918121501945.png)



## 허프 변환

끊긴 에지를 모아 직선 또는 원 등을 검출하는 변환

#### 직선 검출

- 각각의 점 (yi, xi) 에 대해 (b, a) 공간에 직선 b= -axi + yi 를 그린다.
- (b, a) 공간에서 직선이 만나는 점을 `y절편과 기울기` 로 취한다. 



위 방법을 이용해 아래 그림으로 나타내었다. 

![image-20230918121554028]({{site.url}}/images/2023-09-18-2day/image-20230918121554028.png)

### 🖥️ 코드

아래 코드로 프로그램을 실행하면 오류가 많이 발생하는 것을 알 수 있다. 

![image-20230918121629371]({{site.url}}/images/2023-09-18-2day/image-20230918121629371.png)

[해결법]

- 에지 검출 
- 허브 변환
- 검출
- 오류 줄임

위 순서대로 해결한다면 프로그램 오류가 줄어든다. 

(해결한 사진 추후에 추가)





