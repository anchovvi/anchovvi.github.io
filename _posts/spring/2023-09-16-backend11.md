---
layout: single
title: "ê²Œì‹œíŒ í”„ë¡œì íŠ¸-  ê²Œì‹œíŒ ê²€ìƒ‰, ëŒ“ê¸€ êµ¬í˜„"
categories: spring
tags: [java, spring]
sidebar:
    nav: "counts"
---

# 0.ê²€ìƒ‰ ê¸°ëŠ¥ êµ¬í˜„

##  1. ê²€ìƒ‰ ëŒ€ìƒ í•„ë“œë¡œ ê¸°ë³¸ ê²€ìƒ‰ ê¸°ëŠ¥ êµ¬í˜„

### í…ŒìŠ¤íŠ¸ êµ¬í˜„

`ArticleControllerTest`

```java
@DisplayName("[view][GET] ê²Œì‹œê¸€ ë¦¬ìŠ¤íŠ¸ (ê²Œì‹œíŒ) í˜ì´ì§€ - ê²€ìƒ‰ì–´ì™€ í•¨ê»˜ í˜¸ì¶œ")
    @Test
    public void givenSearchKeyword_whenSearchingArticlesView_thenReturnsArticlesView() throws Exception {
        // Given
        SearchType searchType = SearchType.TITLE;   //  ê²€ìƒ‰ íƒ€ì… ì¶”ê°€
        String searchValue = "title";   //  ê²€ìƒ‰ì–´ ì¶”ê°€
        // ì´ì œë¶€í„° ê²€ìƒ‰ íƒ€ì…ê³¼ ê²€ìƒ‰ì–´ë¥¼ ë°›ê¸° ë•Œë¬¸ì— null ê°’ì„ ë„£ëŠ” êµ¬ê°„ì— í•´ë‹¹í•˜ëŠ” ë³€ìˆ˜ë¥¼ ì¶”ê°€í•œë‹¤.
        given(articleService.searchArticles(eq(searchType), eq(searchValue),any(Pageable.class))).willReturn(Page.empty());
        given(paginationService.getPaginationBarNumbers(anyInt(),anyInt())).willReturn(List.of(0,1,2,3,4));
        // When & Then
        mvc.perform(get("/articles")
                        .queryParam("searchType",searchType.name())
                        .queryParam("searchValue",searchValue)
                )
                .andExpect(status().isOk()) // ì •ìƒ í˜¸ì¶œ
                .andExpect(result -> content().contentType(MediaType.TEXT_HTML)) // ë°ì´í„° í™•ì¸
                .andExpect(view().name("articles/index")) // ë·°ì˜ ì¡´ì¬ì—¬ë¶€ ê²€ì‚¬
                .andExpect(model().attributeExists("articles")) // ë·°ì— ëª¨ë¸ ì–´íŠ¸ë¦¬ë·°íŠ¸ë¡œ ë„£ì–´ì¤€ ë°ì´í„°ì¡´ì¬ ì—¬ë¶€ ê²€ì‚¬
                .andExpect(model().attributeExists("searchTypes"));
        then(articleService).should().searchArticles(eq(searchType), eq(searchValue),any(Pageable.class));
        then(paginationService).should().getPaginationBarNumbers(anyInt(),anyInt());
    }
```

ê²Œì‹œíŒ í˜ì´ì§€ì— ê²€ìƒ‰ì–´ì™€ í•¨ê»˜ í˜¸ì¶œí•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸ í•˜ëŠ” ë³€ìˆ˜ë¥¼ ìƒˆë¡œ ìƒì„±í•´ì¤€ë‹¤. 

//Given ì—ì„œ ê²€ìƒ‰ íƒ€ì…ê³¼ ê²€ìƒ‰ì–´ë¥¼ ì¶”ê°€í•œë‹¤. ê·¸ë¦¬ê³  ì •ìƒí˜¸ì¶œê³¼ ë‹¬ë¦¬ null ê°’ì„ ì „ë‹¬í•˜ì§€ ì•Šê³  ê²€ìƒ‰ íƒ€ì…ê³¼ ê²€ìƒ‰ì–´ë¥¼ ë³€ìˆ˜ë¡œ ì „ë‹¬ì‹œì¼œ ì¤€ë‹¤. 

ê·¸ ë‹¤ìŒ //  When & Then ì—ì„œëŠ” performì—ì„œ getìœ¼ë¡œ ë„˜ê²¨ì£¼ëŠ” ê²ƒì—ì„œ ëë‚˜ì§€ ì•Šê³  `queryParam`ì„ ë„˜ê²¨ì¤€ë‹¤. ì´ê²ƒë„ ê²€ìƒ‰ íƒ€ì…ê³¼ ê²€ìƒ‰ì–´ë¥¼ ì‘ì„±í•œë‹¤. 



`ArticleController`

í…ŒìŠ¤íŠ¸ë¡œ êµ¬í˜„í•œ ë‚´ìš©ì„ ë³´ë©´ì„œ êµ¬í˜„í•œë‹¤. 

ì•ì—ì„œ ë‹¤ë¥¸ ê²ƒë“¤ì€ ì „ë¶€ êµ¬í˜„í–ˆìœ¼ë¯€ë¡œ searchTypeë§Œ map.Attribute í•œë‹¤.

```java
map.addAttribute("searchTypes",SearchType.values());
```



![image-20230916143953795]({{site.url}}/images/2023-09-16-backend11/image-20230916143953795.png)

í…ŒìŠ¤íŠ¸ í†µê³¼



## ë·° ê¸°ëŠ¥ ì¶”ê°€

`index.html`

ê²€ìƒ‰ì–´ ë¶€ë¶„ì— id ë¥¼ ë„£ì–´ ìˆ˜ì •í•¨

```html
<select class="form-control" id="search-type" name="searchType">
    <option>ì œëª©</option>
    <option>ë³¸ë¬¸</option>
    <option>id</option>
    <option>ë‹‰ë„¤ì„</option>
    <option>í•´ì‹œíƒœê·¸</option>
</select>
```



`index.th.xml`

```xml
<attr sel="#search-type" th:remove="all-but-first">
    <attr sel="option[0]"
          th:each="searchType : ${searchTypes}"
          th:value="${searchType.name}"	ì´ë¦„ ì‚½ì…
          th:text="${searchType.description}"	ê²€ìƒ‰ì–´ ëª©ë¡ì„ í•œêµ­ì–´ë¡œ ë‚˜íƒ€ë‚´ê³  ì‹¶ì–´ì„œ description ì‚¬ìš©í•¨ 	
          th:selected="${param.searchType !=null && (param.searchType.toString == searchType.name)}"
    />
</attr>
<attr sel="#search-value" th:value="${param.searchValue}" />
```

option ì— í•˜ë‚˜ì˜ ê°’ë§Œ ë†”ë‘ê³  ì „ë¶€ ì œê±°í•¨ 

í•˜ë‚˜ì˜ í•­ëª© `option[0]` ì„ ì´ìš©í•´ ê¸°ëŠ¥ì„ ì¶”ê°€í•¨

ì´ë¦„ì„ ì‚½ì…í•˜ê³ 

`th:text="${searchType.description}"` : ê²€ìƒ‰ì–´ ëª©ë¡ì´ í•œêµ­ì–´ë¡œ ë‚˜íƒ€ë‚˜ë©´ ì¢‹ì„ ê²ƒ ê°™ì•„ì„œ `SearchType` ì„ ìˆ˜ì •í•¨ 

```java
package com.ancho.crud.domain.type;

import lombok.Getter;

public enum SearchType {
//    ê²€ìƒ‰ íƒ€ì…ì— í•„ìš”í•œ ê²ƒì€ ì œëª©, ë³¸ë¬¸, ì•„ì´ë””, ë‹‰ë„¤ì„, í•´ì‹œíƒœê·¸ ì„
    TITLE("ì œëª©"),
    CONTENT("ë³¸ë¬¸"),
    ID("ìœ ì € ID"),
    NICKNAME("ë‹‰ë„¤ì„"),
    HASHTAG("í•´ì‹œíƒœê·¸");

    @Getter private final String description;

    SearchType(String description){
        this.description = description;
    }
}

```



` th:selected="${param.searchType !=null && (param.searchType.toString == searchType.name)}"` 

ì´ê²ƒì€ ê²€ìƒ‰ì„ í•  ë•Œ, ì—°ì†ì ìœ¼ë¡œ ì œëª© ê²€ìƒ‰ í•„í„°ë¥¼ ì„ íƒí–ˆë‹¤ë©´ ê·¸ ë‹¤ìŒì—ë„ ì œëª© í•„í„°ë¡œ ê²€ìƒ‰í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤. 

ì´ìš©ìì˜ í¸ë¦¬ì„±ì„ ìœ„í•´ ë§Œë“¤ì—ˆë‹¤. 



![image-20230916152712311]({{site.url}}/images/2023-09-16-backend11/image-20230916152712311.png)

ì´ì²˜ëŸ¼ ê²€ìƒ‰ ê¸°ëŠ¥ì´ ì˜ ë™ì‘í•˜ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤. 

í•˜ì§€ë§Œ , ê²€ìƒ‰ì„ í•œ ë’¤ ì œëª©ì„ ì •ë ¬í•˜ê²Œ ë˜ë©´ ê²€ìƒ‰ ê¸°ëŠ¥ì´ ìœ ì§€ë˜ì§€ ì•ŠëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤. 

ìœ„ ì˜¤ë¥˜ë¥¼ í•´ê²°í•´ ë³´ì!!!



### ğŸš¨ ê²€ìƒ‰ í›„ ì •ë ¬ ì‹œ ê²€ìƒ‰ ê¸°ëŠ¥ í•´ì œ ì˜¤ë¥˜ 

ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì •ë ¬í•˜ëŠ” ê¸°ëŠ¥ ì¶”ê°€

[ë°©ë²•]

`index.th.xml` íŒŒì¼ì—ì„œ ì •ë ¬ì„ í•˜ëŠ” th ë¶€ë¶„ ìˆ˜ì •

ë§í¬ ë¶€ë¶„ì— `searchType=${param.searchType}, searchValue=${param.searchValue}` ì¶”ê°€í•˜ë©´ ê²€ìƒ‰ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ê³  ë‚˜ì„œ ì •ë ¬ì„ í•´ë„ í•´ë‹¹ ê²€ìƒ‰ì–´ì— ë”°ë¼ ì •ë ¬ì´ ë˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. 

![image-20230916153431296]({{site.url}}/images/2023-09-16-backend11/image-20230916153431296.png)

 

### ğŸš¨ ê²€ìƒ‰ í›„ í˜ì´ì§€ë„¤ì´ì…˜ ê²€ìƒ‰ ê¸°ëŠ¥ í•´ì œ ì˜¤ë¥˜ 

ë§ˆì°¬ ê°€ì§€ë¡œ í˜ì´ì§• ë°”ë¥¼ ëˆ„ë¥´ë©´ ìœ„ì™€ ë˜‘ê°™ì€ ë¬¸ì œê°€ ë°œìƒí•˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. 

ì´ ë¬¸ì œë„ ë§ˆì°¬ê°€ì§€ë¡œ í•´ê²°í•´ë³´ì!!

í˜ì´ì§€ë„¤ì´ì…˜ ë§í¬ ë¶€ë¶„ì— `searchType=${param.searchType}, searchValue=${param.searchValue}` ì¶”ê°€

[ê²€ìƒ‰ í›„]

![image-20230916153803420]({{site.url}}/images/2023-09-16-backend11/image-20230916153803420.png)



[í˜ì´ì§• ë°” ì´ë™ í›„]

![image-20230916153844749]({{site.url}}/images/2023-09-16-backend11/image-20230916153844749.png)
